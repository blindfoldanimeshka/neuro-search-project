# –í–µ–±-—Å–∫—Ä–∞–ø–ø–µ—Ä - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üìñ –û–±–∑–æ—Ä

–í–µ–±-—Å–∫—Ä–∞–ø–ø–µ—Ä - —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Å e-commerce —Å–∞–π—Ç–æ–≤. –û–Ω –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤, –∏–º–µ–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –∑–∞—â–∏—Ç—É –æ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
npm install puppeteer
```

### –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä

```typescript
import { webScraper } from './web-scraper';

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
await webScraper.initialize({ headless: true });

// –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤
const results = await webScraper.scrapeProducts(
  '—Å–º–∞—Ä—Ç—Ñ–æ–Ω',
  ['wildberries'],
  { maxProducts: 10 }
);

console.log(`–ù–∞–π–¥–µ–Ω–æ ${results.totalFound} —Ç–æ–≤–∞—Ä–æ–≤`);
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```typescript
const options: ScrapingOptions = {
  maxProducts: 20,        // –ú–∞–∫—Å–∏–º—É–º —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –ø–æ–∏—Å–∫–∞
  timeout: 30000,         // –¢–∞–π–º–∞—É—Ç –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
  headless: true,         // –§–æ–Ω–æ–≤—ã–π —Ä–µ–∂–∏–º –±—Ä–∞—É–∑–µ—Ä–∞
  delay: 1000,            // –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
  retries: 2,             // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
  scrollToLoad: true,     // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
  maxScrolls: 3,          // –ú–∞–∫—Å–∏–º—É–º –ø—Ä–æ–∫—Ä—É—Ç–æ–∫
  respectRobotsTxt: true, // –£–≤–∞–∂–µ–Ω–∏–µ robots.txt
  viewport: {
    width: 1920,
    height: 1080
  }
};
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

```typescript
const sourceConfig = webScraper.getSourceConfig('wildberries');
console.log(sourceConfig.selectors.productCard); // '.product-card, .j-card'
console.log(sourceConfig.pagination.maxPages);   // 5
```

## üìä –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏

| –ò—Å—Ç–æ—á–Ω–∏–∫ | –û–ø–∏—Å–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|----------|----------|---------|
| **Wildberries** | –†–æ—Å—Å–∏–π—Å–∫–∏–π –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å | ‚úÖ –ê–∫—Ç–∏–≤–µ–Ω |
| **Ozon** | –†–æ—Å—Å–∏–π—Å–∫–∏–π –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å | ‚úÖ –ê–∫—Ç–∏–≤–µ–Ω |
| **Avito** | –†–æ—Å—Å–∏–π—Å–∫–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è | ‚úÖ –ê–∫—Ç–∏–≤–µ–Ω |
| **Yandex.Market** | –Ø–Ω–¥–µ–∫—Å.–ú–∞—Ä–∫–µ—Ç | ‚úÖ –ê–∫—Ç–∏–≤–µ–Ω |
| **Sbermegamarket** | –°–±–µ—Ä–ú–µ–≥–∞–ú–∞—Ä–∫–µ—Ç | ‚úÖ –ê–∫—Ç–∏–≤–µ–Ω |

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã

### `scrapeProducts(query, sources, options)`

–û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤.

```typescript
const results = await webScraper.scrapeProducts(
  '–Ω–æ—É—Ç–±—É–∫',                    // –ü–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
  ['wildberries', 'ozon'],      // –ò—Å—Ç–æ—á–Ω–∏–∫–∏
  { 
    maxProducts: 15,
    delay: 2000,
    headless: true
  }
);
```

### `scrapeBatch(queries, sources, options)`

–ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

```typescript
const batchResults = await webScraper.scrapeBatch(
  ['—Å–º–∞—Ä—Ç—Ñ–æ–Ω', '–Ω–æ—É—Ç–±—É–∫', '–ø–ª–∞–Ω—à–µ—Ç'],
  ['all'],
  { maxProducts: 5 }
);
```

### `getStats()`

–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å–∫—Ä–∞–ø–ø–∏–Ω–≥–∞.

```typescript
const stats = webScraper.getStats();
console.log(`–£—Å–ø–µ—à–Ω–æ—Å—Ç—å: ${stats.successRate.toFixed(2)}%`);
console.log(`–í—Å–µ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤: ${stats.totalRequests}`);
```

## üõ°Ô∏è –ê–Ω—Ç–∏-–±–æ—Ç –∑–∞—â–∏—Ç–∞

–í–µ–±-—Å–∫—Ä–∞–ø–ø–µ—Ä –≤–∫–ª—é—á–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Ä–æ–≤–Ω–µ–π –∑–∞—â–∏—Ç—ã:

- **User-Agent —Ä–æ—Ç–∞—Ü–∏—è** - –°–ª—É—á–∞–π–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
- **–ó–∞–¥–µ—Ä–∂–∫–∏** - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø–∞—É–∑—ã –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
- **–ó–∞–≥–æ–ª–æ–≤–∫–∏** - –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏
- **–ö—É–∫–∏** - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–µ—Å—Å–∏–π –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **–ü—Ä–æ–∫—Å–∏** - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–æ–≤

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

```typescript
interface ScrapingStats {
  totalRequests: number;           // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
  successfulRequests: number;      // –£—Å–ø–µ—à–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
  failedRequests: number;          // –ù–µ—É–¥–∞—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
  totalProducts: number;           // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤
  averageResponseTime: number;     // –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞
  successRate: number;             // –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏
  totalTime: number;               // –û–±—â–µ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã
  sources: Record<string, {        // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º
    requests: number;
    success: number;
    failed: number;
    products: number;
    avgTime: number;
  }>;
  errors: Array<{                  // –î–µ—Ç–∞–ª–∏ –æ—à–∏–±–æ–∫
    source: string;
    error: string;
    timestamp: number;
  }>;
}
```

### –°–æ–±—ã—Ç–∏—è –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å

```typescript
// –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è
webScraper.on('progress', (progress) => {
  console.log(`–ü—Ä–æ–≥—Ä–µ—Å—Å: ${progress.completed}/${progress.total}`);
});

webScraper.on('error', (error) => {
  console.error(`–û—à–∏–±–∫–∞: ${error.error}`);
});
```

## üîÑ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏

```typescript
const options: ScrapingOptions = {
  retries: 3,                    // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫
  delay: 2000,                   // –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏
  exponentialBackoff: true       // –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏
};
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

```typescript
try {
  const results = await webScraper.scrapeProducts('—Ç–æ–≤–∞—Ä', ['wildberries']);
  console.log('–£—Å–ø–µ—à–Ω–æ:', results);
} catch (error) {
  if (error instanceof ScrapingError) {
    console.error(`–û—à–∏–±–∫–∞ —Å–∫—Ä–∞–ø–ø–∏–Ω–≥–∞: ${error.message}`);
    console.error(`–ò—Å—Ç–æ—á–Ω–∏–∫: ${error.source}`);
    console.error(`–ü–æ–ø—ã—Ç–∫–∞: ${error.retryCount}`);
  } else {
    console.error('–ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞:', error);
  }
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –ö–æ–º–ø–∏–ª—è—Ü–∏—è –∏ –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞
npm run test:scraper

# –†–µ–∂–∏–º –Ω–∞–±–ª—é–¥–µ–Ω–∏—è
npm run test:scraper:watch
```

### –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤

```typescript
// test-custom.ts
import { webScraper } from './web-scraper';

async function testCustomScraping() {
  try {
    await webScraper.initialize();
    
    const results = await webScraper.scrapeProducts(
      '—Ç–µ—Å—Ç–æ–≤—ã–π —Ç–æ–≤–∞—Ä',
      ['wildberries'],
      { maxProducts: 2, timeout: 10000 }
    );
    
    console.log('–¢–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω:', results);
  } catch (error) {
    console.error('–¢–µ—Å—Ç –ø—Ä–æ–≤–∞–ª–µ–Ω:', error);
  } finally {
    await webScraper.close();
  }
}

testCustomScraping();
```

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–°–º–æ—Ç—Ä–∏—Ç–µ —Ñ–∞–π–ª `web-scraper-examples.ts` –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤:

- –ë–∞–∑–æ–≤—ã–π –ø–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤
- –ü–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º
- –ö–∞—Å—Ç–æ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∫—Ä–∞–ø–ø–∏–Ω–≥–∞
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–°–æ–±–ª—é–¥–∞–π—Ç–µ robots.txt** - –£–≤–∞–∂–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ —Å–∞–π—Ç–æ–≤
2. **–£–º–µ—Ä–µ–Ω–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏** - –ù–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞–π—Ç–µ —Å–µ—Ä–≤–µ—Ä—ã
3. **–ü—Ä–∞–≤–æ–≤—ã–µ –∞—Å–ø–µ–∫—Ç—ã** - –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –∑–∞–∫–æ–Ω–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –°–ª–µ–¥–∏—Ç–µ –∑–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –∏ –æ—à–∏–±–∫–∞–º–∏
5. **–û–±–Ω–æ–≤–ª–µ–Ω–∏—è** - –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã CSS

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
2. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ CSS
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ç–∏ –∏ –ø—Ä–æ–∫—Å–∏
4. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Puppeteer
5. –°–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Puppeteer Documentation](https://pptr.dev/)
- [CSS Selectors Guide](https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors)
- [Web Scraping Best Practices](https://www.scraperapi.com/blog/web-scraping-best-practices/)
- [Anti-Bot Detection](https://www.scraperapi.com/blog/5-techniques-to-avoid-bot-detection/)
